

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Multi-element Kernels (Separate Parameters) &mdash; flare 1.3.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Cutoff Functions" href="cutoffs.html" />
    <link rel="prev" title="Multi-element Kernels (simple)" href="mc_simple.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> flare
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../flare.html">Python Code Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bffs/bffs.html">Bayesian Force Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learners/learners.html">Bayesian Active Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../md/md.html">ASE MD Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../descriptors/descriptors.html">Descriptors</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="kernels.html">Kernels</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="sc.html">Single-element Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_simple.html">Multi-element Kernels (simple)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Multi-element Kernels (Separate Parameters)</a></li>
<li class="toctree-l3"><a class="reference internal" href="cutoffs.html">Cutoff Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="helper.html">Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../io/io.html">File Input and Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/utils.html">Utility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../flare_pp/flare_pp.html">C++ Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../related.html">Applications/Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/contribute.html">How To Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">How to Cite</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">flare</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../flare.html">Python Code Documentation</a> &raquo;</li>
        
          <li><a href="kernels.html">Kernels</a> &raquo;</li>
        
      <li>Multi-element Kernels (Separate Parameters)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/flare/kernels/mc_sephyps.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-flare.kernels.mc_sephyps">
<span id="multi-element-kernels-separate-parameters"></span><h1>Multi-element Kernels (Separate Parameters)<a class="headerlink" href="#module-flare.kernels.mc_sephyps" title="Permalink to this headline">Â¶</a></h1>
<p>Multicomponent kernels (simple) restrict all signal variance and length scale of hyperparameters
to a single value. The kernels in this module allow you to have different sets of hyperparameters
and cutoffs for different interactions, and have flexible groupings of elements. It also allows
you to do partial hyper-parameter training, keeping some components fixed.</p>
<p>To use this set of kernels, we need a hyps_mask dictionary for GaussianProcess, MappedGaussianProcess,
and AtomicEnvironment (if you also set up different cutoffs).  A simple example is shown below.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">flare.util.parameter_helper</span> <span class="k">import</span> <span class="n">ParameterHelper</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">flare.bffs.gp</span> <span class="k">import</span> <span class="n">GaussianProcess</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pm</span> <span class="o">=</span> <span class="n">ParameterHelper</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="n">kernels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;twobody&#39;</span><span class="p">:[[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">]],</span>
<span class="gp">... </span>                              <span class="s1">&#39;threebody&#39;</span><span class="p">:[[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">]]},</span>
<span class="gp">... </span>                     <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;twobody0&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;twobody1&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                           <span class="s1">&#39;triplet0&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="s1">&#39;triplet1&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">... </span>                           <span class="s1">&#39;cutoff_twobody&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cutoff_threebody&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;noise&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">},</span>
<span class="gp">... </span>                     <span class="n">constraints</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;twobody0&#39;</span><span class="p">:[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hyps_mask</span> <span class="o">=</span> <span class="n">pm1</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hyps</span> <span class="o">=</span> <span class="n">hyps_mask</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;hyps&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cutoffs</span> <span class="o">=</span> <span class="n">hyps_mask</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cutoffs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hyp_labels</span> <span class="o">=</span> <span class="n">hyps_mask</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;hyp_labels&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernels</span> <span class="o">=</span> <span class="n">hyps_mask</span><span class="p">[</span><span class="s1">&#39;kernels&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gp_model</span> <span class="o">=</span> <span class="n">GaussianProcess</span><span class="p">(</span><span class="n">kernels</span><span class="o">=</span><span class="n">kernels</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">hyps</span><span class="o">=</span><span class="n">hyps</span><span class="p">,</span> <span class="n">cutoffs</span><span class="o">=</span><span class="n">cutoffs</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">hyp_labels</span><span class="o">=</span><span class="n">hyp_labels</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">per_atom_par</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">n_cpus</span><span class="o">=</span><span class="n">n_cpus</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">multihyps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hyps_mask</span><span class="o">=</span><span class="n">hm</span><span class="p">)</span>
</pre></div>
</div>
<p>In the example above, Parameters class generates the arrays needed
for these kernels and store all the grouping and mapping information in the
hyps_mask dictionary.  It stores following keys and values:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>spec_mask: 118-long integer array descirbing which elements belong to</dt>
<dd>like groups for determining which bond hyperparameters to use. For
instance, [0,0,1,1,0 â¦] assigns H to group 0, He and Li to group 1,
and Be to group 0 (the 0th register is ignored).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>nspec: Integer, number of different species groups (equal to number of</dt>
<dd>unique values in spec_mask).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>nbond: Integer, number of different hyperparameter sets to associate with</dt>
<dd>different 2-body pairings of atoms in groups defined in spec_mask.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>bond_mask: Array of length nspec^2, which describes the hyperparameter sets to</dt>
<dd>associate with different pairings of species types. For example, if there
are atoms of type 0 and 1, then bond_mask defines which hyperparameters
to use for parings [0-0, 0-1, 1-0, 1-1]: if we wanted hyperparameter set 0 for
0-0 parings and set 1 for 0-1 and 1-1 pairings, then we would make
bond_mask [0, 1, 1, 1].</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>ntriplet: Integer, number of different hyperparameter sets to associate</dt>
<dd>with different 3-body pariings of atoms in groups defined in spec_mask.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>triplet_mask: Similar to bond mask: Triplet pairings of type 0 and 1 atoms</dt>
<dd>would go {0-0-0, 0-0-1, 0-1-0, 0-1-1, 1-0-0, 1-0-1, 1-1-0, 1-1-1},
and if we wanted hyp. set 0 for triplets with only atoms of type 0
and hyp. set 1 for all the rest, then the triplet_mask array would
read [0,1,1,1,1,1,1,1]. The user should make sure that the mask has
a permutational symmetry.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>cutoff_2b: Array of length nbond, which stores the cutoff used for different</dt>
<dd>types of bonds defined in bond_mask</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>ncut3b:    Integer, number of different cutoffs sets to associate</dt>
<dd>with different 3-body pariings of atoms in groups defined in spec_mask.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>cut3b_mask: Array of length nspec^2, which describes the cutoff to</dt>
<dd>associate with different bond types in triplets. For example, in a triplet
(C, O, H) , there are three cutoffs. Cutoffs for CH bond, CO bond and OH bond.
If C and O are associate with atom group 1 in spec_mask and H are associate with
group 0 in spec_mask, the cut3b_mask[1*nspec+0] determines the C/O-H bond cutoff,
and cut3b_mask[1*nspec+1] determines the C-O bond cutoff. If we want the
former one to use the 1st cutoff in cutoff_3b and the later to use the 2nd cutoff
in cutoff_3b, the cut3b_mask should be [0, 0, 0, 1]</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>cutoff_3b: Array of length ncut3b, which stores the cutoff used for different</dt>
<dd>types of bonds in triplets.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>nmb <span class="classifier-delimiter">:</span> <span class="classifier">Integer, number of different cutoffs set to associate with different coordination</span></dt>
<dd>numbers</dd>
</dl>
</li>
<li>mb_mask:   similar to bond_mask and cut3b_mask.</li>
<li>cutoff_mb: Array of length nmb, stores the cutoff used for different many body terms</li>
</ul>
<p>For selective optimization. one can define âmapâ, âtrain_noiseâ and âoriginalâ
to identify which element to be optimized. All three have to be defined.
train_noise = Bool (True/False), whether the noise parameter can be optimized
original: np.array. Full set of initial values for hyperparmeters
map: np.array, array to map the hyper parameter back to the full set.
map[i]=j means the i-th element in hyps should be the j-th element in
hyps_mask[âoriginalâ]</p>
<p>For example, the full set of hyper parmeters
may include [ls21, ls22, sig21, sig22, ls3
sg3, noise] but suppose you wanted only the set 21 optimized.
The full set of hyperparameters is defined in âoriginalâ; include all those
you want to leave static, and set initial guesses for those you want to vary.
Have the âmapâ list contain the indices of the hyperparameters in âoriginalâ
that correspond to the hyperparameters you want to vary.
Have a hyps list which contain those which you want to vary. Below,
ls21, ls22 etcâ¦ represent floating-point variables which correspond
to the initial guesses / static values.
You would then pass in:</p>
<p>hyps = [ls21, sig21]
hyps_mask = { â¦, âtrain_noiseâ: False, âmapâ:[0, 2],</p>
<blockquote>
<div>âoriginalâ: [ls21, ls22, sig21, sig22, ls3, sg3, noise]}</div></blockquote>
<p>the hyps argument should only contain the values that need to be optimized.
If you want noise to be trained as well include noise as the
final hyperparameter value in hyps.</p>
<dl class="function">
<dt id="flare.kernels.mc_sephyps.many_body_mc">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">many_body_mc</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>d2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.many_body_mc" title="Permalink to this definition">Â¶</a></dt>
<dd><p>many-body multi-element kernel between two force components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> â dummy</li>
<li><strong>cutoff_3b</strong> â dummy</li>
<li><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) â cutoff(s) for coordination-based manybody interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> â dummy</li>
<li><strong>bond_mask</strong> â dummy</li>
<li><strong>ntriplet</strong> â dummy</li>
<li><strong>triplet_mask</strong> â dummy</li>
<li><strong>ncut3b</strong> â dummy</li>
<li><strong>cut3b_mask</strong> â dummy</li>
<li><strong>nmb</strong> (<em>int</em>) â number of different hyperparameter sets to associate with manybody pairings</li>
<li><strong>mb_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> â dummy</li>
<li><strong>ls2</strong> â dummy</li>
<li><strong>sig3</strong> â dummy</li>
<li><strong>ls3</strong> â dummy</li>
<li><strong>sigm</strong> (<em>np.ndarray</em>) â signal variances associates with manybody term</li>
<li><strong>lsm</strong> (<em>np.ndarray</em>) â length scales associates with manybody term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3+many-body kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.many_body_mc_en">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">many_body_mc_en</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.many_body_mc_en" title="Permalink to this definition">Â¶</a></dt>
<dd><p>many-body multi-element kernel between two local energies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>hyps</strong> (<em>np.ndarray</em>) â Hyperparameters of the kernel function (sig, ls).</li>
<li><strong>cutoffs</strong> (<em>np.ndarray</em>) â One-element array containing the 2-body
cutoff.</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2-body force/energy kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.many_body_mc_force_en">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">many_body_mc_force_en</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.many_body_mc_force_en" title="Permalink to this definition">Â¶</a></dt>
<dd><p>many-body single-element kernel between two local energies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>hyps</strong> (<em>np.ndarray</em>) â Hyperparameters of the kernel function (sig, ls).</li>
<li><strong>cutoffs</strong> (<em>np.ndarray</em>) â Two-element array containing the 2-, 3-, and
many-body cutoffs.</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the many-body force/energy kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.many_body_mc_grad">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">many_body_mc_grad</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>d2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.many_body_mc_grad" title="Permalink to this definition">Â¶</a></dt>
<dd><p>manybody multi-element kernel between two force components and its
gradient with respect to the hyperparameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> â dummy</li>
<li><strong>cutoff_3b</strong> â dummy</li>
<li><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) â cutoff(s) for coordination-based manybody interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> â dummy</li>
<li><strong>bond_mask</strong> â dummy</li>
<li><strong>ntriplet</strong> â dummy</li>
<li><strong>triplet_mask</strong> â dummy</li>
<li><strong>ncut3b</strong> â dummy</li>
<li><strong>cut3b_mask</strong> â dummy</li>
<li><strong>nmb</strong> (<em>int</em>) â number of different hyperparameter sets to associate with manybody pairings</li>
<li><strong>mb_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> â dummy</li>
<li><strong>ls2</strong> â dummy</li>
<li><strong>sig3</strong> â dummy</li>
<li><strong>ls3</strong> â dummy</li>
<li><strong>sigm</strong> (<em>np.ndarray</em>) â signal variances associates with manybody term</li>
<li><strong>lsm</strong> (<em>np.ndarray</em>) â length scales associates with manybody term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3+manybody kernel and its gradient
with respect to the hyperparameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float, np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.three_body_mc">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">three_body_mc</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>d2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc" title="Permalink to this definition">Â¶</a></dt>
<dd><p>3-body multi-element kernel between two force components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> â dummy</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> â dummy</li>
<li><strong>bond_mask</strong> â dummy</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> â dummy</li>
<li><strong>ls2</strong> â dummy</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3-body force/force kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.three_body_mc_en">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">three_body_mc_en</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc_en" title="Permalink to this definition">Â¶</a></dt>
<dd><p>3-body multi-element kernel between two local energies</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> â dummy</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> â dummy</li>
<li><strong>bond_mask</strong> â dummy</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> â dummy</li>
<li><strong>ls2</strong> â dummy</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3-body energy/energy kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.three_body_mc_force_en">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">three_body_mc_force_en</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc_force_en" title="Permalink to this definition">Â¶</a></dt>
<dd><p>3-body multi-element kernel between a force component and local energies</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> â dummy</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> â dummy</li>
<li><strong>bond_mask</strong> â dummy</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> â dummy</li>
<li><strong>ls2</strong> â dummy</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3-body force/energy kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.three_body_mc_force_en_jit">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">three_body_mc_force_en_jit</code><span class="sig-paren">(</span><em>bond_array_1</em>, <em>c1</em>, <em>etypes1</em>, <em>bond_array_2</em>, <em>c2</em>, <em>etypes2</em>, <em>cross_bond_inds_1</em>, <em>cross_bond_inds_2</em>, <em>cross_bond_dists_1</em>, <em>cross_bond_dists_2</em>, <em>triplets_1</em>, <em>triplets_2</em>, <em>d1</em>, <em>sig</em>, <em>ls</em>, <em>r_cut</em>, <em>cutoff_func</em>, <em>nspec</em>, <em>spec_mask</em>, <em>triplet_mask</em>, <em>cut3b_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc_force_en_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Kernel for 3-body force/energy comparisons.</p>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.three_body_mc_grad">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">three_body_mc_grad</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>d2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc_grad" title="Permalink to this definition">Â¶</a></dt>
<dd><p>3-body multi-element kernel between two force components and its
gradient with respect to the hyperparameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> â dummy</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> â dummy</li>
<li><strong>bond_mask</strong> â dummy</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> â dummy</li>
<li><strong>ls2</strong> â dummy</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3+manybody kernel and its gradient
with respect to the hyperparameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float, np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.three_body_mc_grad_jit">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">three_body_mc_grad_jit</code><span class="sig-paren">(</span><em>bond_array_1</em>, <em>c1</em>, <em>etypes1</em>, <em>bond_array_2</em>, <em>c2</em>, <em>etypes2</em>, <em>cross_bond_inds_1</em>, <em>cross_bond_inds_2</em>, <em>cross_bond_dists_1</em>, <em>cross_bond_dists_2</em>, <em>triplets_1</em>, <em>triplets_2</em>, <em>d1</em>, <em>d2</em>, <em>sig</em>, <em>ls</em>, <em>r_cut</em>, <em>cutoff_func</em>, <em>nspec</em>, <em>spec_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>cut3b_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.three_body_mc_grad_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Kernel gradient for 3-body force comparisons.</p>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_body_mc">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_body_mc</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>d2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2-body multi-element kernel between two force components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> â dummy</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> â dummy</li>
<li><strong>triplet_mask</strong> â dummy</li>
<li><strong>ncut3b</strong> â dummy</li>
<li><strong>cut3b_mask</strong> â dummy</li>
<li><strong>sig2</strong> â dummy</li>
<li><strong>ls2</strong> â dummy</li>
<li><strong>sig3</strong> â dummy</li>
<li><strong>ls3</strong> â dummy</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2-body force/force kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_body_mc_en">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_body_mc_en</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_en" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2-body multi-element kernel between two local energies</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> â dummy</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> â dummy</li>
<li><strong>triplet_mask</strong> â dummy</li>
<li><strong>ncut3b</strong> â dummy</li>
<li><strong>cut3b_mask</strong> â dummy</li>
<li><strong>sig2</strong> â dummy</li>
<li><strong>ls2</strong> â dummy</li>
<li><strong>sig3</strong> â dummy</li>
<li><strong>ls3</strong> â dummy</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2-body energy/energy kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_body_mc_en_jit">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_body_mc_en_jit</code><span class="sig-paren">(</span><em>bond_array_1</em>, <em>c1</em>, <em>etypes1</em>, <em>bond_array_2</em>, <em>c2</em>, <em>etypes2</em>, <em>sig</em>, <em>ls</em>, <em>r_cut</em>, <em>cutoff_func</em>, <em>nspec</em>, <em>spec_mask</em>, <em>bond_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_en_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Multicomponent two-body energy/energy kernel accelerated with
Numbaâs njit decorator.</p>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_body_mc_force_en">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_body_mc_force_en</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_force_en" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2-body multi-element kernel between a force components and local energy</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> â dummy</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> â dummy</li>
<li><strong>triplet_mask</strong> â dummy</li>
<li><strong>ncut3b</strong> â dummy</li>
<li><strong>cut3b_mask</strong> â dummy</li>
<li><strong>sig2</strong> â dummy</li>
<li><strong>ls2</strong> â dummy</li>
<li><strong>sig3</strong> â dummy</li>
<li><strong>ls3</strong> â dummy</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2-body force/energy kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_body_mc_force_en_jit">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_body_mc_force_en_jit</code><span class="sig-paren">(</span><em>bond_array_1</em>, <em>c1</em>, <em>etypes1</em>, <em>bond_array_2</em>, <em>c2</em>, <em>etypes2</em>, <em>d1</em>, <em>sig</em>, <em>ls</em>, <em>r_cut</em>, <em>cutoff_func</em>, <em>nspec</em>, <em>spec_mask</em>, <em>bond_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_force_en_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Multicomponent two-body force/energy kernel accelerated with
Numbaâs njit decorator.</p>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_body_mc_grad">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_body_mc_grad</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>d2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_grad" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2-body multi-element kernel between two force components and its
gradient with respect to the hyperparameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> â dummy</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> â dummy</li>
<li><strong>triplet_mask</strong> â dummy</li>
<li><strong>ncut3b</strong> â dummy</li>
<li><strong>cut3b_mask</strong> â dummy</li>
<li><strong>sig2</strong> (<em>np.ndarray</em>) â signal variances associates with two-body term</li>
<li><strong>ls2</strong> (<em>np.ndarray</em>) â length scales associates with two-body term</li>
<li><strong>sig3</strong> â dummy</li>
<li><strong>ls3</strong> â dummy</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2-body kernel and its gradient
with respect to the hyperparameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float, np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_body_mc_grad_jit">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_body_mc_grad_jit</code><span class="sig-paren">(</span><em>bond_array_1</em>, <em>c1</em>, <em>etypes1</em>, <em>bond_array_2</em>, <em>c2</em>, <em>etypes2</em>, <em>d1</em>, <em>d2</em>, <em>sig</em>, <em>ls</em>, <em>r_cut</em>, <em>cutoff_func</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_grad_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Multicomponent two-body force/force kernel gradient accelerated with
Numbaâs njit decorator.</p>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_body_mc_jit">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_body_mc_jit</code><span class="sig-paren">(</span><em>bond_array_1</em>, <em>c1</em>, <em>etypes1</em>, <em>bond_array_2</em>, <em>c2</em>, <em>etypes2</em>, <em>d1</em>, <em>d2</em>, <em>sig</em>, <em>ls</em>, <em>r_cut</em>, <em>cutoff_func</em>, <em>nspec</em>, <em>spec_mask</em>, <em>bond_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_body_mc_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Multicomponent two-body force/force kernel accelerated with Numbaâs
njit decorator.
Loops over bonds in two environments and adds to the kernel if bonds are
of the same type.</p>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_plus_three_body_mc">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_plus_three_body_mc</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>d2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_plus_three_body_mc" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2+3-body multi-element kernel between two force components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) â cutoff(s) for coordination-based manybody interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> (<em>np.ndarray</em>) â signal variances associates with two-body term</li>
<li><strong>ls2</strong> (<em>np.ndarray</em>) â length scales associates with two-body term</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3-body force/force kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_plus_three_body_mc_grad">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_plus_three_body_mc_grad</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>d2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_plus_three_body_mc_grad" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2+3-body multi-element kernel between two force components and its
gradient with respect to the hyperparameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> (<em>np.ndarray</em>) â signal variances associates with two-body term</li>
<li><strong>ls2</strong> (<em>np.ndarray</em>) â length scales associates with two-body term</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3-body kernel and its gradient
with respect to the hyperparameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float, np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_plus_three_mc_en">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_plus_three_mc_en</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_plus_three_mc_en" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2+3-body multi-element kernel between two local energies</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) â cutoff(s) for coordination-based manybody interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> (<em>np.ndarray</em>) â signal variances associates with two-body term</li>
<li><strong>ls2</strong> (<em>np.ndarray</em>) â length scales associates with two-body term</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3-body energy/energy kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_plus_three_mc_force_en">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_plus_three_mc_force_en</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_plus_three_mc_force_en" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2+3-body multi-element kernel between force and local energy</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) â cutoff(s) for coordination-based manybody interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> (<em>np.ndarray</em>) â signal variances associates with two-body term</li>
<li><strong>ls2</strong> (<em>np.ndarray</em>) â length scales associates with two-body term</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3-body force/energy kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_three_many_body_mc">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_three_many_body_mc</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>d2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_three_many_body_mc" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2+3+manybody multi-element kernel between two force components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) â cutoff(s) for coordination-based manybody interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>nmb</strong> (<em>int</em>) â number of different hyperparameter sets to associate with manybody pairings</li>
<li><strong>mb_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> (<em>np.ndarray</em>) â signal variances associates with two-body term</li>
<li><strong>ls2</strong> (<em>np.ndarray</em>) â length scales associates with two-body term</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>sigm</strong> (<em>np.ndarray</em>) â signal variances associates with manybody term</li>
<li><strong>lsm</strong> (<em>np.ndarray</em>) â length scales associates with manybody term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3+many-body kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_three_many_body_mc_grad">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_three_many_body_mc_grad</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>d2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_three_many_body_mc_grad" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2+3+manybody multi-element kernel between two force components and its
gradient with respect to the hyperparameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) â cutoff(s) for coordination-based manybody interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>nmb</strong> (<em>int</em>) â number of different hyperparameter sets to associate with manybody pairings</li>
<li><strong>mb_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> (<em>np.ndarray</em>) â signal variances associates with two-body term</li>
<li><strong>ls2</strong> (<em>np.ndarray</em>) â length scales associates with two-body term</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>sigm</strong> (<em>np.ndarray</em>) â signal variances associates with manybody term</li>
<li><strong>lsm</strong> (<em>np.ndarray</em>) â length scales associates with manybody term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3+manybody kernel and its gradient
with respect to the hyperparameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float, np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_three_many_mc_en">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_three_many_mc_en</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_three_many_mc_en" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2+3+many-body multi-element kernel between two local energies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) â cutoff(s) for coordination-based manybody interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>nmb</strong> (<em>int</em>) â number of different hyperparameter sets to associate with manybody pairings</li>
<li><strong>mb_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> (<em>np.ndarray</em>) â signal variances associates with two-body term</li>
<li><strong>ls2</strong> (<em>np.ndarray</em>) â length scales associates with two-body term</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>sigm</strong> (<em>np.ndarray</em>) â signal variances associates with manybody term</li>
<li><strong>lsm</strong> (<em>np.ndarray</em>) â length scales associates with manybody term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3+many-body energy/energy kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_sephyps.two_three_many_mc_force_en">
<code class="descclassname">flare.kernels.mc_sephyps.</code><code class="descname">two_three_many_mc_force_en</code><span class="sig-paren">(</span><em>env1</em>, <em>env2</em>, <em>d1</em>, <em>cutoff_2b</em>, <em>cutoff_3b</em>, <em>cutoff_mb</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nbond</em>, <em>bond_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>ncut3b</em>, <em>cut3b_mask</em>, <em>nmb</em>, <em>mb_mask</em>, <em>sig2</em>, <em>ls2</em>, <em>sig3</em>, <em>ls3</em>, <em>sigm</em>, <em>lsm</em>, <em>cutoff_func=&lt;function quadratic_cutoff&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_sephyps.two_three_many_mc_force_en" title="Permalink to this definition">Â¶</a></dt>
<dd><p>2+3+manybody multi-element kernel between a force component and a local
energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env1</strong> (<em>AtomicEnvironment</em>) â First local environment.</li>
<li><strong>env2</strong> (<em>AtomicEnvironment</em>) â Second local environment.</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>cutoff_2b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for two-body interaction</li>
<li><strong>cutoff_3b</strong> (<em>float, np.ndarray</em>) â cutoff(s) for three-body interaction</li>
<li><strong>cutoff_mb</strong> (<em>float, np.ndarray</em>) â cutoff(s) for coordination-based manybody interaction</li>
<li><strong>nspec</strong> (<em>int</em>) â number of different species groups</li>
<li><strong>spec_mask</strong> (<em>np.ndarray</em>) â 118-long integer array that determines specie group</li>
<li><strong>nbond</strong> (<em>int</em>) â number of different hyperparameter sets to associate with two-body pairings</li>
<li><strong>bond_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>ntriplet</strong> (<em>int</em>) â number of different hyperparameter sets to associate with 3-body pairings</li>
<li><strong>triplet_mask</strong> (<em>np.ndarray</em>) â nspec^3 long integer array</li>
<li><strong>ncut3b</strong> (<em>int</em>) â number of different 3-body cutoff sets to associate with 3-body pairings</li>
<li><strong>cut3b_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>nmb</strong> (<em>int</em>) â number of different hyperparameter sets to associate with manybody pairings</li>
<li><strong>mb_mask</strong> (<em>np.ndarray</em>) â nspec^2 long integer array</li>
<li><strong>sig2</strong> (<em>np.ndarray</em>) â signal variances associates with two-body term</li>
<li><strong>ls2</strong> (<em>np.ndarray</em>) â length scales associates with two-body term</li>
<li><strong>sig3</strong> (<em>np.ndarray</em>) â signal variances associates with three-body term</li>
<li><strong>ls3</strong> (<em>np.ndarray</em>) â length scales associates with three-body term</li>
<li><strong>sigm</strong> (<em>np.ndarray</em>) â signal variances associates with manybody term</li>
<li><strong>lsm</strong> (<em>np.ndarray</em>) â length scales associates with manybody term</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function of the kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the 2+3+many-body force/energy kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-flare.kernels.mc_3b_sepcut"></span><p>Implementation of three-body kernels using different cutoffs.</p>
<p>The kernels are slightly slower.</p>
<dl class="function">
<dt id="flare.kernels.mc_3b_sepcut.three_body_mc_force_en_sepcut_jit">
<code class="descclassname">flare.kernels.mc_3b_sepcut.</code><code class="descname">three_body_mc_force_en_sepcut_jit</code><span class="sig-paren">(</span><em>bond_array_1</em>, <em>c1</em>, <em>etypes1</em>, <em>bond_array_2</em>, <em>c2</em>, <em>etypes2</em>, <em>cross_bond_inds_1</em>, <em>cross_bond_inds_2</em>, <em>cross_bond_dists_1</em>, <em>cross_bond_dists_2</em>, <em>triplets_1</em>, <em>triplets_2</em>, <em>d1</em>, <em>sig</em>, <em>ls</em>, <em>r_cut</em>, <em>cutoff_func</em>, <em>nspec</em>, <em>spec_mask</em>, <em>triplet_mask</em>, <em>cut3b_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_3b_sepcut.three_body_mc_force_en_sepcut_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Kernel for 3-body force/energy comparisons.</p>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_3b_sepcut.three_body_mc_grad_sepcut_jit">
<code class="descclassname">flare.kernels.mc_3b_sepcut.</code><code class="descname">three_body_mc_grad_sepcut_jit</code><span class="sig-paren">(</span><em>bond_array_1</em>, <em>c1</em>, <em>etypes1</em>, <em>bond_array_2</em>, <em>c2</em>, <em>etypes2</em>, <em>cross_bond_inds_1</em>, <em>cross_bond_inds_2</em>, <em>cross_bond_dists_1</em>, <em>cross_bond_dists_2</em>, <em>triplets_1</em>, <em>triplets_2</em>, <em>d1</em>, <em>d2</em>, <em>sig</em>, <em>ls</em>, <em>r_cut</em>, <em>cutoff_func</em>, <em>nspec</em>, <em>spec_mask</em>, <em>ntriplet</em>, <em>triplet_mask</em>, <em>cut3b_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_3b_sepcut.three_body_mc_grad_sepcut_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Kernel gradient for 3-body force comparisons.</p>
</dd></dl>

<span class="target" id="module-flare.kernels.mc_mb_sepcut"></span><p>Implementation of three-body kernels using different cutoffs.</p>
<p>The kernels are slightly slower.</p>
<dl class="function">
<dt id="flare.kernels.mc_mb_sepcut.many_body_mc_en_sepcut_jit">
<code class="descclassname">flare.kernels.mc_mb_sepcut.</code><code class="descname">many_body_mc_en_sepcut_jit</code><span class="sig-paren">(</span><em>q_array_1</em>, <em>q_array_2</em>, <em>c1</em>, <em>c2</em>, <em>species1</em>, <em>species2</em>, <em>sig</em>, <em>ls</em>, <em>nspec</em>, <em>spec_mask</em>, <em>mb_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_mb_sepcut.many_body_mc_en_sepcut_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>many-body many-element kernel between energy components accelerated
with Numba.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bond_array_1</strong> (<em>np.ndarray</em>) â many-body bond array of the first local
environment.</li>
<li><strong>bond_array_2</strong> (<em>np.ndarray</em>) â many-body bond array of the second local
environment.</li>
<li><strong>c1</strong> (<em>int</em>) â atomic species of the central atom in env 1</li>
<li><strong>c2</strong> (<em>int</em>) â atomic species of the central atom in env 2</li>
<li><strong>etypes1</strong> (<em>np.ndarray</em>) â atomic species of atoms in env 1</li>
<li><strong>etypes2</strong> (<em>np.ndarray</em>) â atomic species of atoms in env 2</li>
<li><strong>species1</strong> (<em>np.ndarray</em>) â all the atomic species present in trajectory 1</li>
<li><strong>species2</strong> (<em>np.ndarray</em>) â all the atomic species present in trajectory 2</li>
<li><strong>sig</strong> (<em>float</em>) â many-body signal variance hyperparameter.</li>
<li><strong>ls</strong> (<em>float</em>) â many-body length scale hyperparameter.</li>
<li><strong>r_cut</strong> (<em>float</em>) â many-body cutoff radius.</li>
<li><strong>cutoff_func</strong> (<em>Callable</em>) â Cutoff function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the many-body kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_mb_sepcut.many_body_mc_force_en_sepcut_jit">
<code class="descclassname">flare.kernels.mc_mb_sepcut.</code><code class="descname">many_body_mc_force_en_sepcut_jit</code><span class="sig-paren">(</span><em>q_array_1</em>, <em>q_array_2</em>, <em>q_neigh_array_1</em>, <em>q_neigh_grads_1</em>, <em>c1</em>, <em>c2</em>, <em>etypes1</em>, <em>species1</em>, <em>species2</em>, <em>d1</em>, <em>sig</em>, <em>ls</em>, <em>nspec</em>, <em>spec_mask</em>, <em>mb_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_mb_sepcut.many_body_mc_force_en_sepcut_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>many-body many-element kernel between force and energy components accelerated
with Numba.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>To be complete</strong></li>
<li><strong>c1</strong> (<em>int</em>) â atomic species of the central atom in env 1</li>
<li><strong>c2</strong> (<em>int</em>) â atomic species of the central atom in env 2</li>
<li><strong>etypes1</strong> (<em>np.ndarray</em>) â atomic species of atoms in env 1</li>
<li><strong>species1</strong> (<em>np.ndarray</em>) â all the atomic species present in trajectory 1</li>
<li><strong>species2</strong> (<em>np.ndarray</em>) â all the atomic species present in trajectory 2</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>sig</strong> (<em>float</em>) â many-body signal variance hyperparameter.</li>
<li><strong>ls</strong> (<em>float</em>) â many-body length scale hyperparameter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the many-body kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_mb_sepcut.many_body_mc_grad_sepcut_jit">
<code class="descclassname">flare.kernels.mc_mb_sepcut.</code><code class="descname">many_body_mc_grad_sepcut_jit</code><span class="sig-paren">(</span><em>q_array_1</em>, <em>q_array_2</em>, <em>q_neigh_array_1</em>, <em>q_neigh_array_2</em>, <em>q_neigh_grads_1</em>, <em>q_neigh_grads_2</em>, <em>c1</em>, <em>c2</em>, <em>etypes1</em>, <em>etypes2</em>, <em>species1</em>, <em>species2</em>, <em>d1</em>, <em>d2</em>, <em>sig</em>, <em>ls</em>, <em>nspec</em>, <em>spec_mask</em>, <em>nmb</em>, <em>mb_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_mb_sepcut.many_body_mc_grad_sepcut_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>gradient of many-body multi-element kernel between two force components
w.r.t. the hyperparameters, accelerated with Numba.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c1</strong> (<em>int</em>) â atomic species of the central atom in env 1</li>
<li><strong>c2</strong> (<em>int</em>) â atomic species of the central atom in env 2</li>
<li><strong>etypes1</strong> (<em>np.ndarray</em>) â atomic species of atoms in env 1</li>
<li><strong>etypes2</strong> (<em>np.ndarray</em>) â atomic species of atoms in env 2</li>
<li><strong>species1</strong> (<em>np.ndarray</em>) â all the atomic species present in trajectory 1</li>
<li><strong>species2</strong> (<em>np.ndarray</em>) â all the atomic species present in trajectory 2</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>sig</strong> (<em>float</em>) â many-body signal variance hyperparameter.</li>
<li><strong>ls</strong> (<em>float</em>) â many-body length scale hyperparameter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the many-body kernel and its gradient w.r.t. sig and ls</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flare.kernels.mc_mb_sepcut.many_body_mc_sepcut_jit">
<code class="descclassname">flare.kernels.mc_mb_sepcut.</code><code class="descname">many_body_mc_sepcut_jit</code><span class="sig-paren">(</span><em>q_array_1</em>, <em>q_array_2</em>, <em>q_neigh_array_1</em>, <em>q_neigh_array_2</em>, <em>q_neigh_grads_1</em>, <em>q_neigh_grads_2</em>, <em>c1</em>, <em>c2</em>, <em>etypes1</em>, <em>etypes2</em>, <em>species1</em>, <em>species2</em>, <em>d1</em>, <em>d2</em>, <em>sig</em>, <em>ls</em>, <em>nspec</em>, <em>spec_mask</em>, <em>mb_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#flare.kernels.mc_mb_sepcut.many_body_mc_sepcut_jit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>many-body multi-element kernel between two force components accelerated
with Numba.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c1</strong> (<em>int</em>) â atomic species of the central atom in env 1</li>
<li><strong>c2</strong> (<em>int</em>) â atomic species of the central atom in env 2</li>
<li><strong>etypes1</strong> (<em>np.ndarray</em>) â atomic species of atoms in env 1</li>
<li><strong>etypes2</strong> (<em>np.ndarray</em>) â atomic species of atoms in env 2</li>
<li><strong>species1</strong> (<em>np.ndarray</em>) â all the atomic species present in trajectory 1</li>
<li><strong>species2</strong> (<em>np.ndarray</em>) â all the atomic species present in trajectory 2</li>
<li><strong>d1</strong> (<em>int</em>) â Force component of the first environment.</li>
<li><strong>d2</strong> (<em>int</em>) â Force component of the second environment.</li>
<li><strong>sig</strong> (<em>float</em>) â many-body signal variance hyperparameter.</li>
<li><strong>ls</strong> (<em>float</em>) â many-body length scale hyperparameter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Value of the many-body kernel.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cutoffs.html" class="btn btn-neutral float-right" title="Cutoff Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mc_simple.html" class="btn btn-neutral float-left" title="Multi-element Kernels (simple)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Jonathan Vandermause, Yu Xie, Anders Johansson, Cameron Owen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>